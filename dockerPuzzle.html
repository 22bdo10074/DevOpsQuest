<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üê≥ Docker Architecture Puzzle - DevOpsQuest</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body {
      font-family: "Orbitron", "Rajdhani", sans-serif;
      background: radial-gradient(circle at 20% 20%, #010a1a, #000);
      color: #d6faff;
      text-align: center;
      padding: 30px;
      min-height: 100vh;
      overflow-x: hidden;
    }
    h1 {
      color: #00f7ff;
      text-shadow: 0 0 15px #00f7ff;
      margin-bottom: 10px;
    }
    .panel {
      background: rgba(0, 20, 40, 0.7);
      border: 2px solid rgba(0, 255, 255, 0.25);
      border-radius: 15px;
      padding: 25px;
      width: 85%;
      max-width: 950px;
      margin: 25px auto;
      box-shadow: 0 0 25px rgba(0,255,255,0.15);
      text-align: left;
    }
    .diagram {
      text-align: center;
      margin: 20px auto;
    }
    .diagram img {
      width: 80%;
      max-width: 600px;
      border-radius: 12px;
      box-shadow: 0 0 25px rgba(0,255,255,0.15);
    }
    ul {
      line-height: 1.8;
      font-size: 1.05em;
      color: #bafcff;
    }
    button {
      margin-top: 20px;
      padding: 12px 25px;
      border: none;
      border-radius: 10px;
      background: linear-gradient(90deg, #00ffc8, #00f7ff);
      color: #001821;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 0 20px rgba(0,255,255,0.3);
      transition: 0.3s;
      font-size: 1.1em;
    }
    button:hover {
      transform: scale(1.05);
      box-shadow: 0 0 30px #00ffc8;
    }
    .puzzle-area {
      border: 2px dashed rgba(0,255,255,0.3);
      border-radius: 15px;
      padding: 20px;
      margin-top: 25px;
      background: rgba(0, 30, 50, 0.5);
      display: none;
    }
    .drag-item {
      display: inline-block;
      background: rgba(0,255,255,0.15);
      border: 1px solid rgba(0,255,255,0.25);
      padding: 10px 20px;
      border-radius: 8px;
      margin: 8px;
      cursor: grab;
      font-weight: 600;
      color: #00ffc8;
      transition: 0.2s;
    }
    .drag-item.dragging {
      opacity: 0.5;
      transform: scale(0.9);
    }
    .drop-zone {
      min-height: 100px;
      border: 2px dashed rgba(0,255,255,0.25);
      border-radius: 12px;
      padding: 10px;
      margin-top: 15px;
    }
    .feedback {
      text-align: center;
      font-weight: bold;
      font-size: 1.1em;
      margin-top: 10px;
    }
    .correct { color: #00ffc8; text-shadow: 0 0 10px #00ffc8; }
    .wrong { color: #ff6b88; text-shadow: 0 0 10px #ff6b88; }
  </style>
</head>

<body>
  <h1>üê≥ Docker Architecture Puzzle</h1>
  <p>Understand the Docker architecture and solve the puzzle to prove your mastery!</p>

  <!-- üìò Learning Section -->
  <div id="learnSection" class="panel">
    <h2>üìò Learn Docker Architecture</h2>
    <p>Docker follows a client-server architecture. It has three main components: the Docker Client, Docker Daemon, and Docker Registry.</p>

    <div class="diagram">
      <img src="https://media.geeksforgeeks.org/wp-content/uploads/20240715175319/Docker-Architecture.webp" alt="Docker Architecture Diagram">
    </div>

    <ul>
      <li><b>Docker Client:</b> The command-line tool that users interact with. It sends commands (like <code>docker build</code>, <code>docker run</code>) to the daemon.</li>
      <li><b>Docker Daemon:</b> The background service responsible for building, running, and managing containers.</li>
      <li><b>Docker Images:</b> Read-only templates used to create containers. Each image has layers built on top of base images.</li>
      <li><b>Docker Containers:</b> Lightweight, runnable instances of Docker images. They run isolated processes.</li>
      <li><b>Docker Registry:</b> A centralized repository (like Docker Hub) for storing and distributing Docker images.</li>
    </ul>

    <center><button id="startPuzzle">üß© Start Puzzle Challenge</button></center>
  </div>

  <!-- üß© Puzzle Section -->
  <div id="puzzleSection" class="panel puzzle-area">
    <h2>üß† Arrange Docker Architecture Terms</h2>
    <p>Drag and drop the following Docker components in the correct architecture order:</p>

    <div id="termsContainer">
      <div class="drag-item" draggable="true">Docker Daemon</div>
      <div class="drag-item" draggable="true">Docker Client</div>
      <div class="drag-item" draggable="true">Docker Registry</div>
      <div class="drag-item" draggable="true">Docker Images</div>
      <div class="drag-item" draggable="true">Docker Containers</div>
    </div>

    <h3 style="margin-top:20px;">Drop Here üëá</h3>
    <div id="dropZone" class="drop-zone"></div>
    <div id="feedback" class="feedback"></div>
    <button id="checkOrder" style="display:none;">‚úÖ Check Order</button>
  </div>

  <!-- üéµ Music -->
  <audio id="bgMusic" src="assets/bgm.mp3" loop></audio>
  <audio id="sfxSuccess" src="assets/sfx_success.mp3"></audio>
  <audio id="sfxFail" src="assets/sfx_wrong.mp3"></audio>

  <script>
    const learnSection = document.getElementById("learnSection");
    const puzzleSection = document.getElementById("puzzleSection");
    const startPuzzle = document.getElementById("startPuzzle");
    const dropZone = document.getElementById("dropZone");
    const checkOrder = document.getElementById("checkOrder");
    const feedback = document.getElementById("feedback");
    const bgMusic = document.getElementById("bgMusic");
    const sfxSuccess = document.getElementById("sfxSuccess");
    const sfxFail = document.getElementById("sfxFail");

    // üéµ Play background music
    bgMusic.volume = 0.3;
    bgMusic.play().catch(() => {
      console.log("Autoplay blocked ‚Äî music will start on first interaction");
      document.body.addEventListener("click", () => bgMusic.play(), { once: true });
    });

    // ‚úÖ Correct sequence
    const correctOrder = [
      "Docker Client",
      "Docker Daemon",
      "Docker Images",
      "Docker Containers",
      "Docker Registry"
    ];

    startPuzzle.addEventListener("click", () => {
      learnSection.style.display = "none";
      puzzleSection.style.display = "block";
      checkOrder.style.display = "inline-block";
    });

    // üéØ Drag and Drop Logic
    let draggedItem = null;

    document.querySelectorAll(".drag-item").forEach(item => {
      item.addEventListener("dragstart", () => {
        draggedItem = item;
        item.classList.add("dragging");
      });
      item.addEventListener("dragend", () => {
        draggedItem.classList.remove("dragging");
        draggedItem = null;
      });
    });

    dropZone.addEventListener("dragover", e => e.preventDefault());
    dropZone.addEventListener("drop", e => {
      e.preventDefault();
      if (draggedItem) dropZone.appendChild(draggedItem);
    });

    // ‚úÖ Check puzzle order
    checkOrder.addEventListener("click", () => {
      const items = Array.from(dropZone.querySelectorAll(".drag-item")).map(i => i.textContent.trim());
      if (items.length !== correctOrder.length) {
        feedback.textContent = "‚ö†Ô∏è Please place all components in order.";
        feedback.className = "feedback wrong";
        sfxFail.play();
        return;
      }

      const correct = items.every((v, i) => v === correctOrder[i]);
      if (correct) {
        feedback.textContent = "üéâ Correct! Docker Architecture Mastered!";
        feedback.className = "feedback correct";
        sfxSuccess.play();
        setTimeout(() => completePuzzle(), 2500);
      } else {
        feedback.textContent = "‚ùå Incorrect order! Try again.";
        feedback.className = "feedback wrong";
        sfxFail.play();
      }
    });

    // üéâ Completion Logic
    function completePuzzle() {
      // Stop background music
      let fade = setInterval(() => {
        if (bgMusic.volume > 0.05) bgMusic.volume -= 0.05;
        else {
          bgMusic.pause();
          bgMusic.volume = 0.3;
          clearInterval(fade);
        }
      }, 80);

      // XP + Unlock logic
      const unlocked = JSON.parse(localStorage.getItem("unlockedQuests") || "[]");
      if (!unlocked.includes("Kubernetes Quest")) unlocked.push("Kubernetes Quest");
      localStorage.setItem("unlockedQuests", JSON.stringify(unlocked));
      localStorage.setItem("nextQuest", "kubernetes");
      localStorage.setItem("xp", parseInt(localStorage.getItem("xp") || 0) + 300);

      // üéä Confetti Animation
      for (let i = 0; i < 40; i++) {
        const c = document.createElement("div");
        c.style.position = "fixed";
        c.style.width = "10px";
        c.style.height = "10px";
        c.style.top = "0";
        c.style.left = Math.random() * window.innerWidth + "px";
        c.style.background = ["#00ffc8","#00f7ff","#ff7b9b"][Math.floor(Math.random()*3)];
        c.style.animation = "fall 2.5s linear forwards";
        c.style.opacity = "0.9";
        c.style.borderRadius = "3px";
        document.body.appendChild(c);
        setTimeout(() => c.remove(), 2500);
      }

      // üåç Redirect
      setTimeout(() => {
        alert("üéâ Level Up! You‚Äôve completed Docker Puzzle. Kubernetes Quest Unlocked!");
        window.location.href = "dockerMCQ.html";
      }, 3500);
    }
  </script>

  <style>
    @keyframes fall {
      0% { transform: translateY(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(600px) rotate(720deg); opacity: 0; }
    }
  </style>
</body>
</html>
